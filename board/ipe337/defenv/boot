
exec /env/config

if [ "$root" = flash ]; then
	bootargs="$bootargs root=/dev/mtdblock3"
else
	bootargs="$bootargs root=/dev/nfs nfsroot=$eth0.serverip:$nfsroot,v3,tcp"
fi

if [ "$ip" = dhcp ]; then
	bootargs="$bootargs ip=dhcp"
else
	bootargs="$bootargs ip=$eth0.ip:$eth0.serverip:$eth0.gateway:$eth0.netmask:::"
fi

bootargs="$bootargs mtdparts=physmap-flash.0:$mtdparts"

if [ "$kernel" = net ]; then
	if [ $ip = dhcp ]; then
		dhcp
	fi
	tftpboot uImage $uimage
	bootm uImage
else
	bootm /dev/$jffs2dev
fi
